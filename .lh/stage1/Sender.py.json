{
    "sourceFile": "stage1/Sender.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1652546059721,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1652546319279,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,29 +2,37 @@\n \n \n \n class Sender(threading.Thread):\n-    def __init__(self, ip, port, filepath, flag, socket):\n+    def __init__(self, ip, port, file, flag, socket):\n         threading.Thread.__init__(self)\n         self.ip = ip\n         self.port = port\n-        self.filepath = filepath\n+        self.file = file\n         self.s = socket\n         self.f = open(filepath, 'rb')\n         self.buffer = 2048\n         self.type = flag # 0 for song, 1 for options, 2 for strings\n+        \n     def run(self):\n         self.s = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)\n         self.s.setsockopt(socket.IPPROTO_IPV6, socket.IPV6_MULTICAST_HOPS, 1)\n         self.s.setsockopt(socket.IPPROTO_IPV6, socket.IPV6_MULTICAST_LOOP, 1)\n-        data = self.f.read(self.buffer)\n-        print(\"File Read in Sender\")\n-        while(data):\n-            print(\"Trying to send..\")\n-            if(self.s.sendto(data,(self.ip,self.port))):\n-                data=self.f.read(self.buffer)\n-                print(\"file sent\")\n-                time.sleep(0.05)\n-        self.f.close()\n-        print(\"Song sent on multicast\")\n-\n+        if self.type == 0:\n+            data = self.f.read(self.buffer)\n+            print(\"Ficheiro lido no Sender\")\n+            while(data):\n+                print(\"A tentar enviar..\")\n+                if(self.s.sendto(data,(self.ip,self.port))):\n+                    data=self.f.read(self.buffer)\n+                    print(\"ficheiro enviado\")\n+                    time.sleep(0.05)\n+            self.f.close()\n+            print(\"Ficheiro enviado em multicast\")\n+        \n+        elif self.type == 1:\n+            data = self.file\n+            print(\"Sending songs\")\n+            \n+            while(data):\n+                print(\"E\")\n     \n\\ No newline at end of file\n"
                },
                {
                    "date": 1652546555321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-import socket, time, threading\n+import socket, time, threading,json\n \n \n \n class Sender(threading.Thread):\n@@ -8,9 +8,9 @@\n         self.ip = ip\n         self.port = port\n         self.file = file\n         self.s = socket\n-        self.f = open(filepath, 'rb')\n+        self.f = open(file, 'rb')\n         self.buffer = 2048\n         self.type = flag # 0 for song, 1 for options, 2 for strings\n         \n     def run(self):\n@@ -27,12 +27,25 @@\n                     print(\"ficheiro enviado\")\n                     time.sleep(0.05)\n             self.f.close()\n             print(\"Ficheiro enviado em multicast\")\n-        \n+        #enviar opções de jogo em formato json(dicionário)\n         elif self.type == 1:\n             data = self.file\n-            print(\"Sending songs\")\n-            \n+            print(\"A enviar opcoes de musicas\")\n             while(data):\n\\ No newline at end of file\n-                print(\"E\")\n-    \n+                print(\"A tentar enviar\")\n+                self.s.sendto(json.dumps(self.file),(self.ip,self.port))\n+                time.sleep(0.05)\n+                print(\"ficheiro enviado\")\n+            print(\"Opções enviadas em multicast\")\n+        #enviar strings passadas como argumento\n+        elif self.type == 2:\n+            data = self.file\n+            print(\"A enviar strings\")\n+            while(data):\n+                print(\"A tentar enviar\")\n+                self.s.sendto(data,(self.ip,self.port))\n+                time.sleep(0.05)\n+                print(\"ficheiro enviado\")\n+            print(\"String % s enviada em multicast\" % self.file)\n+        \n\\ No newline at end of file\n"
                }
            ],
            "date": 1652546059721,
            "name": "Commit-0",
            "content": "import socket, time, threading\n\n\n\nclass Sender(threading.Thread):\n    def __init__(self, ip, port, filepath, flag, socket):\n        threading.Thread.__init__(self)\n        self.ip = ip\n        self.port = port\n        self.filepath = filepath\n        self.s = socket\n        self.f = open(filepath, 'rb')\n        self.buffer = 2048\n        self.type = flag # 0 for song, 1 for options, 2 for strings\n    def run(self):\n        self.s = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)\n        self.s.setsockopt(socket.IPPROTO_IPV6, socket.IPV6_MULTICAST_HOPS, 1)\n        self.s.setsockopt(socket.IPPROTO_IPV6, socket.IPV6_MULTICAST_LOOP, 1)\n        data = self.f.read(self.buffer)\n        print(\"File Read in Sender\")\n        while(data):\n            print(\"Trying to send..\")\n            if(self.s.sendto(data,(self.ip,self.port))):\n                data=self.f.read(self.buffer)\n                print(\"file sent\")\n                time.sleep(0.05)\n        self.f.close()\n        print(\"Song sent on multicast\")\n\n    "
        }
    ]
}